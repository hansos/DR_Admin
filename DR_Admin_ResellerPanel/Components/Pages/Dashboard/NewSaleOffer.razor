@page "/dashboard/new-sale/offer"

<div id="dashboard-new-sale-offer-page" class="container-fluid">
    <div class="d-flex flex-wrap justify-content-between align-items-center gap-3 mb-3">
        <div>
            <h2 class="h4 mb-1"><i class="bi bi-receipt"></i> New sale</h2>
            <p class="text-muted mb-0">Page 5 of 7: Present offer.</p>
        </div>
    </div>

    <div id="new-sale-offer-alert-success" class="alert alert-success d-none" role="alert"></div>
    <div id="new-sale-offer-alert-error" class="alert alert-danger d-none" role="alert"></div>

    <div class="card shadow-sm mb-4">
        <div class="card-header bg-light">
            <h5 class="mb-0"><i class="bi bi-info-circle"></i> Sale context</h5>
        </div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-12 col-md-3">
                    <div class="text-muted small">Domain</div>
                    <div class="fw-semibold" id="new-sale-offer-domain">-</div>
                </div>
                <div class="col-12 col-md-3">
                    <div class="text-muted small">Flow type</div>
                    <div class="fw-semibold" id="new-sale-offer-flow">-</div>
                </div>
                <div class="col-12 col-md-3">
                    <div class="text-muted small">Customer</div>
                    <div class="fw-semibold" id="new-sale-offer-customer">-</div>
                </div>
                <div class="col-12 col-md-3">
                    <div class="text-muted small">Currency</div>
                    <div class="fw-semibold" id="new-sale-offer-currency">-</div>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow-sm mb-4">
        <div class="card-header bg-light">
            <h5 class="mb-0"><i class="bi bi-sliders"></i> Quote settings</h5>
        </div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-12 col-lg-4">
                    <label class="form-label" for="new-sale-offer-valid-until">Valid until</label>
                    <input class="form-control" id="new-sale-offer-valid-until" type="date" />
                </div>
                <div class="col-12 col-lg-4">
                    <label class="form-label" for="new-sale-offer-coupon">Coupon code</label>
                    <input class="form-control" id="new-sale-offer-coupon" type="text" placeholder="Optional" autocomplete="off" />
                </div>
                <div class="col-12 col-lg-4">
                    <label class="form-label" for="new-sale-offer-discount">Discount (%)</label>
                    <input class="form-control" id="new-sale-offer-discount" type="number" min="0" max="100" step="0.01" placeholder="0" />
                </div>
                <div class="col-12">
                    <label class="form-label" for="new-sale-offer-notes">Quote notes</label>
                    <textarea class="form-control" id="new-sale-offer-notes" rows="2" placeholder="Visible in offer communication"></textarea>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow-sm mb-4">
        <div class="card-header bg-light d-flex flex-wrap justify-content-between align-items-center gap-2">
            <h5 class="mb-0"><i class="bi bi-list-check"></i> Quote line items</h5>
            <span class="badge text-bg-secondary" id="new-sale-offer-line-count">0 lines</span>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead>
                        <tr>
                            <th>Description</th>
                            <th class="text-center">Qty</th>
                            <th class="text-end">Unit</th>
                            <th class="text-end">Subtotal</th>
                            <th class="text-end">Type</th>
                        </tr>
                    </thead>
                    <tbody id="new-sale-offer-lines-body">
                        <tr><td colspan="5" class="text-center text-muted">Loading offer lines...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="card shadow-sm mb-4">
        <div class="card-header bg-light">
            <h5 class="mb-0"><i class="bi bi-calculator"></i> Totals</h5>
        </div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-12 col-md-4">
                    <div class="small text-muted">One-time subtotal</div>
                    <div class="fw-semibold" id="new-sale-offer-total-onetime">-</div>
                </div>
                <div class="col-12 col-md-4">
                    <div class="small text-muted">Recurring subtotal</div>
                    <div class="fw-semibold" id="new-sale-offer-total-recurring">-</div>
                </div>
                <div class="col-12 col-md-4">
                    <div class="small text-muted">Estimated grand total</div>
                    <div class="fw-semibold" id="new-sale-offer-total-grand">-</div>
                </div>
            </div>
        </div>
    </div>

    <div class="d-flex flex-wrap justify-content-between gap-2 mb-4">
        <div class="d-flex flex-wrap gap-2">
            <a class="btn btn-outline-secondary" href="/dashboard/new-sale"><i class="bi bi-pencil"></i> Edit Page 1</a>
            <a class="btn btn-outline-secondary" href="/dashboard/new-sale/customer"><i class="bi bi-pencil"></i> Edit Page 2</a>
            <a class="btn btn-outline-secondary" href="/dashboard/new-sale/hosting"><i class="bi bi-pencil"></i> Edit Page 3</a>
            <a class="btn btn-outline-secondary" href="/dashboard/new-sale/services"><i class="bi bi-pencil"></i> Edit Page 4</a>
        </div>
        <div class="d-flex flex-wrap gap-2">
            <button class="btn btn-outline-primary" id="new-sale-offer-send" type="button"><i class="bi bi-envelope"></i> Send to customer</button>
            <button class="btn btn-primary" id="new-sale-offer-accept" type="button">Accept and continue <i class="bi bi-arrow-right"></i></button>
        </div>
    </div>
</div>
