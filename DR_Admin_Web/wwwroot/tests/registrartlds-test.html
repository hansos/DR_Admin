<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrar TLDs API Test - DR Admin</title>
    <link href="/lib/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/test-page.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="/choose-test.html">DR Admin - Registrar TLDs API</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><span class="user-info" id="userInfo"></span></li>
                    <li class="nav-item"><a href="/choose-test.html" class="btn btn-back">&#8592; Back to Tests</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-main">
        <div class="header-card">
            <h1>&#127760; Registrar TLDs API Test</h1>
            <p>Test CRUD operations for RegistrarTlds and lookup endpoints</p>
        </div>

        <div id="alertContainer"></div>

        <!-- Create RegistrarTld Section -->
        <div class="test-section">
            <h2 class="section-title">&#10133; Create Registrar TLD</h2>
            <form id="createForm">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="createRegistrarId" class="form-label">Registrar ID *</label>
                        <input type="number" class="form-control" id="createRegistrarId" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="createTldId" class="form-label">TLD ID *</label>
                        <input type="number" class="form-control" id="createTldId" placeholder="e.g., 14170" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="createRegistrationCost" class="form-label">Registration Cost *</label>
                        <input type="number" step="0.01" class="form-control" id="createRegistrationCost" placeholder="0.00" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="createRegistrationPrice" class="form-label">Registration Price *</label>
                        <input type="number" step="0.01" class="form-control" id="createRegistrationPrice" placeholder="0.00" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="createRenewalCost" class="form-label">Renewal Cost *</label>
                        <input type="number" step="0.01" class="form-control" id="createRenewalCost" placeholder="0.00" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="createRenewalPrice" class="form-label">Renewal Price *</label>
                        <input type="number" step="0.01" class="form-control" id="createRenewalPrice" placeholder="0.00" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="createTransferCost" class="form-label">Transfer Cost *</label>
                        <input type="number" step="0.01" class="form-control" id="createTransferCost" placeholder="0.00" required>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="createTransferPrice" class="form-label">Transfer Price *</label>
                        <input type="number" step="0.01" class="form-control" id="createTransferPrice" placeholder="0.00" required>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="createPrivacyCost" class="form-label">Privacy Cost</label>
                        <input type="number" step="0.01" class="form-control" id="createPrivacyCost" placeholder="0.00">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="createPrivacyPrice" class="form-label">Privacy Price</label>
                        <input type="number" step="0.01" class="form-control" id="createPrivacyPrice" placeholder="0.00">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <label for="createCurrency" class="form-label">Currency</label>
                        <input type="text" class="form-control" id="createCurrency" placeholder="USD" value="USD">
                    </div>
                    <div class="col-md-4 mb-3">
                        <label for="createIsActive" class="form-label">Active</label>
                        <select class="form-control" id="createIsActive">
                            <option value="true" selected>Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                    <div class="col-md-4 mb-3">
                        <label for="createAutoRenew" class="form-label">Auto Renew</label>
                        <select class="form-control" id="createAutoRenew">
                            <option value="false" selected>No</option>
                            <option value="true">Yes</option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="createMinYears" class="form-label">Min Years</label>
                        <input type="number" class="form-control" id="createMinYears" placeholder="1" value="1">
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="createMaxYears" class="form-label">Max Years</label>
                        <input type="number" class="form-control" id="createMaxYears" placeholder="10" value="10">
                    </div>
                </div>
                <div class="mb-3">
                    <label for="createNotes" class="form-label">Notes</label>
                    <textarea class="form-control" id="createNotes" rows="2"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Create Registrar TLD</button>
            </form>
        </div>

        <!-- Get All RegistrarTlds Section -->
        <div class="test-section">
            <h2 class="section-title">&#128203; Get All Registrar TLDs</h2>
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="pageSize" class="form-label">Page Size</label>
                    <select id="pageSize" class="form-control" onchange="getAllRegistrarTlds()">
                        <option value="5" selected>5</option>
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="pageNumber" class="form-label">Page Number</label>
                    <input id="pageNumber" type="number" class="form-control" value="1" min="1" onchange="getAllRegistrarTlds()">
                </div>
                <div class="col-md-6 d-flex align-items-end">
                    <button class="btn btn-primary" onclick="getAllRegistrarTlds()">Load All Registrar TLDs</button>
                </div>
            </div>
            <div class="mb-3">
                <label class="form-label">Filter by Status:</label>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-outline-primary active" id="filterAll" onclick="setFilter('all')">All</button>
                    <button type="button" class="btn btn-outline-success" id="filterActive" onclick="setFilter('active')">Active</button>
                    <button type="button" class="btn btn-outline-secondary" id="filterInactive" onclick="setFilter('inactive')">Inactive</button>
                </div>
            </div>
            <div id="pagingInfo" class="mb-2"></div>
            <div class="loading" id="loadingAll"><div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div></div>
            <div id="registrarTldsTableContainer"></div>
            <div id="pagingControls" class="mt-3"></div>
        </div>

        <!-- Get RegistrarTld by ID Section -->
        <div class="test-section">
            <h2 class="section-title">&#128269; Get Registrar TLD by ID</h2>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="getRegistrarTldId" class="form-label">ID</label>
                    <input type="number" class="form-control" id="getRegistrarTldId">
                </div>
                <div class="col-md-8 mb-3 d-flex align-items-end">
                    <button class="btn btn-primary" onclick="getRegistrarTldById()">Get Registrar TLD</button>
                </div>
            </div>
            <div class="loading" id="loadingById"><div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div></div>
            <div id="registrarTldByIdResult"></div>
        </div>

        <!-- Available TLDs -->
        <div class="test-section">
            <h2 class="section-title">&#127760; Get Available TLDs</h2>
            <button class="btn btn-primary mb-3" onclick="getAvailableTlds()">Load Available TLDs</button>
            <div class="loading" id="loadingAvailable"><div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div></div>
            <div id="availableTldsContainer"></div>
        </div>

        <!-- Get TLDs for Registrar -->
        <div class="test-section">
            <h2 class="section-title">&#128101; Get TLDs for Registrar</h2>
            <div class="row mb-3">
                <div class="col-md-3">
                    <label for="getForRegistrarId" class="form-label">Registrar ID</label>
                    <input type="number" class="form-control" id="getForRegistrarId">
                </div>
                <div class="col-md-2">
                    <label for="registrarPageSize" class="form-label">Page Size</label>
                    <select id="registrarPageSize" class="form-control">
                        <option value="5" selected>5</option>
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <label for="registrarPageNumber" class="form-label">Page Number</label>
                    <input id="registrarPageNumber" type="number" class="form-control" value="1" min="1">
                </div>
                <div class="col-md-5 d-flex align-items-end">
                    <button class="btn btn-primary" onclick="getTldsForRegistrar()">Get TLDs</button>
                </div>
            </div>
            <div class="mb-3">
                <label class="form-label">Filter by Status:</label>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-outline-primary active" id="registrarFilterAll" onclick="setRegistrarFilter('all')">All</button>
                    <button type="button" class="btn btn-outline-success" id="registrarFilterActive" onclick="setRegistrarFilter('active')">Active</button>
                    <button type="button" class="btn btn-outline-secondary" id="registrarFilterInactive" onclick="setRegistrarFilter('inactive')">Inactive</button>
                </div>
            </div>
            <div id="registrarPagingInfo" class="mb-2"></div>
            <div class="loading" id="loadingForRegistrar"><div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div></div>
            <div id="tldsForRegistrarContainer"></div>
            <div id="registrarPagingControls" class="mt-3"></div>
        </div>

        <!-- Check specific Registrar TLD -->
        <div class="test-section">
            <h2 class="section-title">&#128270; Check Registrar TLD</h2>
            <div class="row">
                <div class="col-md-3 mb-3">
                    <label for="checkRegistrarId" class="form-label">Registrar ID</label>
                    <input type="number" class="form-control" id="checkRegistrarId">
                </div>
                <div class="col-md-5 mb-3">
                    <label for="checkTldId" class="form-label">TLD ID</label>
                    <input type="number" class="form-control" id="checkTldId">
                </div>
                <div class="col-md-4 mb-3 d-flex align-items-end">
                    <button class="btn btn-primary" onclick="checkRegistrarTld()">Check</button>
                </div>
            </div>
            <div class="loading" id="loadingCheck"><div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div></div>
            <div id="checkResult"></div>
        </div>

        <!-- Bulk Update All Registrar TLDs Status -->
        <div class="test-section">
            <h2 class="section-title">&#128260; Bulk Update All Registrar TLDs Status</h2>
            <p>Set all registrar-TLD offerings to active or inactive (optionally filtered by registrar)</p>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="bulkUpdateAllRegistrarId" class="form-label">Registrar ID (optional)</label>
                    <input type="number" class="form-control" id="bulkUpdateAllRegistrarId" placeholder="Leave empty for all registrars">
                    <small class="form-text text-muted">Leave empty to update all registrars</small>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="bulkUpdateAllStatus" class="form-label">Set Status</label>
                    <select class="form-control" id="bulkUpdateAllStatus">
                        <option value="true">Active</option>
                        <option value="false">Inactive</option>
                    </select>
                </div>
                <div class="col-md-4 mb-3 d-flex align-items-end">
                    <button class="btn btn-warning" onclick="bulkUpdateAllStatus()">Update Registrar TLDs</button>
                </div>
            </div>
            <div class="loading" id="loadingBulkUpdateAll"><div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div></div>
            <div id="bulkUpdateAllResult"></div>
        </div>

        <!-- Bulk Update Registrar TLDs by TLD Extensions -->
        <div class="test-section">
            <h2 class="section-title">&#128260; Bulk Update Registrar TLDs by TLD Extensions</h2>
            <p>Set registrar-TLD offerings for specific TLD extensions to active or inactive (optionally filtered by registrar)</p>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="bulkUpdateByTldRegistrarId" class="form-label">Registrar ID (optional)</label>
                    <input type="number" class="form-control" id="bulkUpdateByTldRegistrarId" placeholder="Leave empty for all registrars">
                    <small class="form-text text-muted">Leave empty to update all registrars</small>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="bulkUpdateTldExtensions" class="form-label">TLD Extensions (comma-separated)</label>
                    <input type="text" class="form-control" id="bulkUpdateTldExtensions" placeholder="e.g., com,net,org">
                    <small class="form-text text-muted">Enter TLD extensions separated by commas</small>
                </div>
                <div class="col-md-2 mb-3">
                    <label for="bulkUpdateByTldStatus" class="form-label">Set Status</label>
                    <select class="form-control" id="bulkUpdateByTldStatus">
                        <option value="true">Active</option>
                        <option value="false">Inactive</option>
                    </select>
                </div>
                <div class="col-md-2 mb-3 d-flex align-items-end">
                    <button class="btn btn-warning" onclick="bulkUpdateStatusByTld()">Update by TLD</button>
                </div>
            </div>
            <div class="loading" id="loadingBulkUpdateByTld"><div class="spinner-border" role="status"><span class="visually-hidden">Loading...</span></div></div>
            <div id="bulkUpdateByTldResult"></div>
        </div>

        <!-- API Response -->
        <div class="test-section">
            <h2 class="section-title">&#128225; Last API Response</h2>
            <div class="response-box" id="responseBox">No API calls made yet...</div>
        </div>

    </div>

    <!-- Edit Modal -->
    <div class="modal fade" id="editModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">&#9998; Edit Registrar TLD</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editForm">
                        <input type="hidden" id="editId">
                        <input type="hidden" id="editTldId">
                        <div class="mb-3">
                            <label for="editRegistrarName" class="form-label">Registrar</label>
                            <input type="text" class="form-control" id="editRegistrarName" readonly>
                        </div>
                        <input type="hidden" id="editRegistrarId">
                        <div class="mb-3">
                            <label for="editTldExtension" class="form-label">TLD</label>
                            <input type="text" class="form-control" id="editTldExtension" readonly>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="editRegistrationCost" class="form-label">Registration Cost *</label>
                                <input type="number" step="0.01" class="form-control" id="editRegistrationCost" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="editRegistrationPrice" class="form-label">Registration Price *</label>
                                <input type="number" step="0.01" class="form-control" id="editRegistrationPrice" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="editRenewalCost" class="form-label">Renewal Cost *</label>
                                <input type="number" step="0.01" class="form-control" id="editRenewalCost" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="editRenewalPrice" class="form-label">Renewal Price *</label>
                                <input type="number" step="0.01" class="form-control" id="editRenewalPrice" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="editTransferCost" class="form-label">Transfer Cost *</label>
                                <input type="number" step="0.01" class="form-control" id="editTransferCost" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="editTransferPrice" class="form-label">Transfer Price *</label>
                                <input type="number" step="0.01" class="form-control" id="editTransferPrice" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="editPrivacyCost" class="form-label">Privacy Cost</label>
                                <input type="number" step="0.01" class="form-control" id="editPrivacyCost">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="editPrivacyPrice" class="form-label">Privacy Price</label>
                                <input type="number" step="0.01" class="form-control" id="editPrivacyPrice">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="editCurrency" class="form-label">Currency *</label>
                                <input type="text" class="form-control" id="editCurrency" required>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="editIsActive" class="form-label">Active</label>
                                <select class="form-control" id="editIsActive">
                                    <option value="true">Yes</option>
                                    <option value="false">No</option>
                                </select>
                            </div>
                            <div class="col-md-4 mb-3">
                                <label for="editAutoRenew" class="form-label">Auto Renew</label>
                                <select class="form-control" id="editAutoRenew">
                                    <option value="true">Yes</option>
                                    <option value="false">No</option>
                                </select>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="editMinYears" class="form-label">Min Years</label>
                                <input type="number" class="form-control" id="editMinYears">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="editMaxYears" class="form-label">Max Years</label>
                                <input type="number" class="form-control" id="editMaxYears">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="editNotes" class="form-label">Notes</label>
                            <textarea class="form-control" id="editNotes" rows="2"></textarea>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="updateRegistrarTld()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/js/authClient.js"></script>
  <script src="/assets/js/authGuard.js"></script>
    <script>
        let currentRegistrarTlds = [];
        let currentFilter = 'all';
        let currentRegistrarFilter = 'all';
        let editModal;

        window.addEventListener('DOMContentLoaded', async () => {
            const token = authClient.getToken(); if (!token) { window.location.href = '/login.html'; return; }
            const result = await authClient.verifyToken(); if (result.authenticated && result.data?.username) document.getElementById('userInfo').textContent = `Hello, ${result.data.username}!`; else document.getElementById('userInfo').textContent = 'Hello, User!';

            editModal = new bootstrap.Modal(document.getElementById('editModal'));
            document.getElementById('createForm').addEventListener('submit', handleCreate);
            getAllRegistrarTlds();
        });

        function showAlert(message, type='info') { const alertContainer = document.getElementById('alertContainer'); const alertHtml = `\n                <div class="alert alert-${type} alert-dismissible fade show" role="alert">${message}<button type="button" class="btn-close" data-bs-dismiss="alert"></button></div>`; alertContainer.innerHTML = alertHtml; setTimeout(()=>{ const a = alertContainer.querySelector('.alert'); if (a) bootstrap.Alert.getOrCreateInstance(a).close(); },5000); }
        function updateResponseBox(data) { document.getElementById('responseBox').textContent = JSON.stringify(data, null, 2); }
        function getAuthHeaders() { const token = authClient.getToken(); return { 'Content-Type':'application/json', 'Authorization': `Bearer ${token}` }; }

        async function handleCreate(e) {
            e.preventDefault();
            const data = {
                registrarId: parseInt(document.getElementById('createRegistrarId').value),
                tldId: parseInt(document.getElementById('createTldId').value),
                registrationCost: parseFloat(document.getElementById('createRegistrationCost').value),
                registrationPrice: parseFloat(document.getElementById('createRegistrationPrice').value),
                renewalCost: parseFloat(document.getElementById('createRenewalCost').value),
                renewalPrice: parseFloat(document.getElementById('createRenewalPrice').value),
                transferCost: parseFloat(document.getElementById('createTransferCost').value),
                transferPrice: parseFloat(document.getElementById('createTransferPrice').value),
                privacyCost: document.getElementById('createPrivacyCost').value ? parseFloat(document.getElementById('createPrivacyCost').value) : null,
                privacyPrice: document.getElementById('createPrivacyPrice').value ? parseFloat(document.getElementById('createPrivacyPrice').value) : null,
                currency: document.getElementById('createCurrency').value.trim() || 'USD',
                isActive: document.getElementById('createIsActive').value === 'true',
                autoRenew: document.getElementById('createAutoRenew').value === 'true',
                minRegistrationYears: document.getElementById('createMinYears').value ? parseInt(document.getElementById('createMinYears').value) : 1,
                maxRegistrationYears: document.getElementById('createMaxYears').value ? parseInt(document.getElementById('createMaxYears').value) : 10,
                notes: document.getElementById('createNotes').value.trim() || null
            };
            try {
                const res = await fetch(`${API_BASE_URL}/api/v1/RegistrarTlds`, { method:'POST', headers: getAuthHeaders(), body: JSON.stringify(data) });
                let result; const ct = res.headers.get('content-type'); if (ct && ct.includes('application/json')) result = await res.json(); else { const text = await res.text(); result = { error: text, statusCode: res.status }; }
                updateResponseBox(result);
                if (res.ok) { showAlert('Registrar TLD created','success'); document.getElementById('createForm').reset(); document.getElementById('createCurrency').value = 'USD'; document.getElementById('createMinYears').value = 1; document.getElementById('createMaxYears').value = 10; getAllRegistrarTlds(); } else showAlert(`Error: ${result.message||result.error||'Failed to create'}`,'danger');
            } catch (err) { showAlert(`Error: ${err.message}`,'danger'); updateResponseBox({ error: err.message }); }
        }

        async function getAllRegistrarTlds() {
            const pageSize = parseInt(document.getElementById('pageSize').value);
            const pageNumber = parseInt(document.getElementById('pageNumber').value);
            
            const loading = document.getElementById('loadingAll');
            const container = document.getElementById('registrarTldsTableContainer');
            const pagingInfo = document.getElementById('pagingInfo');
            const pagingControls = document.getElementById('pagingControls');
            
            loading.style.display='block';
            container.innerHTML='';
            pagingInfo.innerHTML='';
            pagingControls.innerHTML='';
            
            try {
                // Build URL with filter parameter
                let url = `${API_BASE_URL}/api/v1/RegistrarTlds?pageNumber=${pageNumber}&pageSize=${pageSize}`;
                if (currentFilter === 'active') {
                    url += '&isActive=true';
                } else if (currentFilter === 'inactive') {
                    url += '&isActive=false';
                }
                
                const res = await fetch(url, {
                    method:'GET',
                    headers: getAuthHeaders()
                });
                let data;
                const ct = res.headers.get('content-type');
                if (ct && ct.includes('application/json')) {
                    data = await res.json();
                } else {
                    const text = await res.text();
                    data = { error: text, statusCode: res.status };
                }
                updateResponseBox(data);
                
                if (res.ok) {
                    // Check if paginated result
                    if (data && data.data && Array.isArray(data.data) && data.totalCount !== undefined) {
                        // Paginated response - no client-side filtering needed
                        currentRegistrarTlds = data.data;
                        renderRegistrarTldsTable(data.data);
                        renderPagingInfo(data);
                        renderPagingControls(data);
                    } else if (Array.isArray(data)) {
                        // Non-paginated array response
                        currentRegistrarTlds = data;
                        renderRegistrarTldsTable(data);
                    } else {
                        console.error('Unexpected data structure:', data);
                        showAlert('Unexpected data structure received from API', 'warning');
                        container.innerHTML = '<div class="empty-state">Error: Unexpected data format. Check console for details.</div>';
                    }
                } else {
                    showAlert(`Error: ${data.message||data.error||'Failed to fetch'}`,'danger');
                }
            } catch (err) {
                console.error('Error in getAllRegistrarTlds:', err);
                showAlert(`Error: ${err.message}`,'danger');
                updateResponseBox({ error: err.message });
            } finally {
                loading.style.display='none';
            }
        }

        function renderRegistrarTldsTable(items) {
            const container = document.getElementById('registrarTldsTableContainer'); if (!items || items.length===0) { container.innerHTML = '<div class="empty-state">No registrar TLDs found</div>'; return; }
            const tableHtml = `
                <div class="table-responsive">
                    <table class="table">
                        <thead><tr><th>ID</th><th>Registrar</th><th>TLD</th><th>Active</th><th>Registration Price</th><th>Renewal Price</th><th>Actions</th></tr></thead>
                        <tbody>${items.map(i=>`<tr><td>${i.id}</td><td>${i.registrarName||i.registrarId}</td><td><code>${i.tldExtension||'-'}</code></td><td><span class="badge ${i.isActive?'badge-success':'badge-secondary'}">${i.isActive?'Active':'Inactive'}</span></td><td>${i.registrationPrice||'-'}</td><td>${i.renewalPrice||'-'}</td><td><div class="action-buttons"><button class="btn btn-sm btn-warning" onclick="openEditModal(${i.id})">Edit</button><button class="btn btn-sm btn-danger" onclick="deleteRegistrarTld(${i.id}, '${(i.tldExtension||'').replace(/'/g, "\\'" )}')">Delete</button></div></td></tr>`).join('')}</tbody>
                    </table>
                </div>`;
            container.innerHTML = tableHtml;
        }


        async function getRegistrarTldById() {
            const id = document.getElementById('getRegistrarTldId').value; if (!id) { showAlert('Please enter an ID','warning'); return; }
            const loading = document.getElementById('loadingById'); const result = document.getElementById('registrarTldByIdResult'); loading.style.display='block'; result.innerHTML='';
            try {
                const res = await fetch(`${API_BASE_URL}/api/v1/RegistrarTlds/${id}`, { method:'GET', headers: getAuthHeaders() });
                let data; const ct = res.headers.get('content-type'); if (ct && ct.includes('application/json')) data = await res.json(); else { const text = await res.text(); data = { error: text, statusCode: res.status }; }
                updateResponseBox(data);
                if (res.ok) { result.innerHTML = `<div class="alert alert-success"><h5>Registrar TLD Found:</h5><p><strong>ID:</strong> ${data.id}</p><p><strong>Registrar:</strong> ${data.registrarName||data.registrarId}</p><p><strong>TLD:</strong> <code>${data.tldExtension}</code></p><p><strong>Active:</strong> ${data.isActive? 'Yes':'No'}</p><p><strong>Registration Price:</strong> ${data.registrationPrice||'N/A'}</p><p><strong>Renewal Price:</strong> ${data.renewalPrice||'N/A'}</p><p><strong>Notes:</strong> ${data.notes||'N/A'}</p></div>`; } else showAlert(`Error: ${data.message||data.error||'Not found'}`,'danger');
            } catch (err) { showAlert(`Error: ${err.message}`,'danger'); updateResponseBox({ error: err.message }); } finally { loading.style.display='none'; }
        }

        async function getAvailableTlds() {
            const loading = document.getElementById('loadingAvailable'); const container = document.getElementById('availableTldsContainer'); loading.style.display='block'; container.innerHTML='';
            try {
                const res = await fetch(`${API_BASE_URL}/api/v1/RegistrarTlds/available`, { method:'GET', headers: getAuthHeaders() });
                let data; const ct = res.headers.get('content-type'); if (ct && ct.includes('application/json')) data = await res.json(); else { const text = await res.text(); data = { error: text, statusCode: res.status }; }
                updateResponseBox(data);
                if (res.ok) { if (!data || data.length===0) container.innerHTML = '<div class="empty-state">No available TLDs</div>'; else container.innerHTML = `<div class="alert alert-success"><h5>Available TLDs (${data.length}):</h5><ul>${data.map(t=>`<li><code>${t.tldExtension}</code> - Registrar: ${t.registrarName||t.registrarId} - Price: ${t.registrationPrice||'N/A'}</li>`).join('')}</ul></div>`; } else showAlert(`Error: ${data.message||data.error||'Failed to fetch'}`,'danger');
            } catch (err) { showAlert(`Error: ${err.message}`,'danger'); updateResponseBox({ error: err.message }); } finally { loading.style.display='none'; }
        }

        async function getTldsForRegistrar() {
            const registrarId = document.getElementById('getForRegistrarId').value;
            if (!registrarId) {
                showAlert('Please enter registrar ID','warning');
                return;
            }
            
            const pageSize = parseInt(document.getElementById('registrarPageSize').value);
            const pageNumber = parseInt(document.getElementById('registrarPageNumber').value);
            
            const loading = document.getElementById('loadingForRegistrar');
            const container = document.getElementById('tldsForRegistrarContainer');
            const pagingInfo = document.getElementById('registrarPagingInfo');
            const pagingControls = document.getElementById('registrarPagingControls');
            
            loading.style.display='block';
            container.innerHTML='';
            pagingInfo.innerHTML='';
            pagingControls.innerHTML='';
            
            try {
                // Build URL with filter parameter
                let url = `${API_BASE_URL}/api/v1/RegistrarTlds/registrar/${registrarId}?pageNumber=${pageNumber}&pageSize=${pageSize}`;
                if (currentRegistrarFilter === 'active') {
                    url += '&isActive=true';
                } else if (currentRegistrarFilter === 'inactive') {
                    url += '&isActive=false';
                }
                
                const res = await fetch(url, {
                    method:'GET',
                    headers: getAuthHeaders()
                });
                let data;
                const ct = res.headers.get('content-type');
                if (ct && ct.includes('application/json')) {
                    data = await res.json();
                } else {
                    const text = await res.text();
                    data = { error: text, statusCode: res.status };
                }
                updateResponseBox(data);
                
                if (res.ok) {
                    // Check if paginated result
                    if (data && data.data && Array.isArray(data.data) && data.totalCount !== undefined) {
                        // Paginated response - no client-side filtering needed
                        if (data.data.length === 0 && data.totalCount === 0) {
                            container.innerHTML = '<div class="empty-state">No TLDs found for this registrar with selected filter</div>';
                        } else {
                            renderRegistrarTldsList(data.data, container);
                            renderRegistrarPagingInfo(data);
                            renderRegistrarPagingControls(data);
                        }
                    } else if (Array.isArray(data)) {
                        // Non-paginated array response
                        if (data.length === 0) {
                            container.innerHTML = '<div class="empty-state">No TLDs for this registrar with selected filter</div>';
                        } else {
                            renderRegistrarTldsList(data, container);
                        }
                    } else {
                        console.error('Unexpected data structure:', data);
                        showAlert('Unexpected data structure received from API', 'warning');
                        container.innerHTML = '<div class="empty-state">Error: Unexpected data format</div>';
                    }
                } else {
                    showAlert(`Error: ${data.message||data.error||'Failed to fetch'}`,'danger');
                }
            } catch (err) {
                console.error('Error in getTldsForRegistrar:', err);
                showAlert(`Error: ${err.message}`,'danger');
                updateResponseBox({ error: err.message });
            } finally {
                loading.style.display='none';
            }
        }
        
        function renderRegistrarTldsList(items, container) {
            const count = items.length;
            container.innerHTML = `<div class="alert alert-success"><h5>TLDs for Registrar (${count}):</h5><ul>${items.map(t=>`<li><code>${t.tldExtension}</code> - ID: ${t.id} - ${t.isActive? 'Active':'Inactive'} - Price: ${t.registrationPrice||'N/A'}</li>`).join('')}</ul></div>`;
        }

        async function checkRegistrarTld() {
            const registrarId = document.getElementById('checkRegistrarId').value; const tldId = document.getElementById('checkTldId').value; if (!registrarId || !tldId) { showAlert('Provide registrar ID and TLD ID','warning'); return; }
            const loading = document.getElementById('loadingCheck'); const result = document.getElementById('checkResult'); loading.style.display='block'; result.innerHTML='';
            try {
                const res = await fetch(`${API_BASE_URL}/api/v1/RegistrarTlds/registrar/${registrarId}/tld/${tldId}`, { method:'GET', headers: getAuthHeaders() });
                let data; const ct = res.headers.get('content-type'); if (ct && ct.includes('application/json')) data = await res.json(); else { const text = await res.text(); data = { error: text, statusCode: res.status }; }
                updateResponseBox(data);
                if (res.ok) { result.innerHTML = `<div class="alert alert-success"><p><strong>Registrar TLD:</strong> ID ${data.id} - <code>${data.tldExtension}</code> - ${data.isActive? 'Active':'Inactive'}</p></div>`; } else showAlert(`Error: ${data.message||data.error||'Not found'}`,'danger');
            } catch (err) { showAlert(`Error: ${err.message}`,'danger'); updateResponseBox({ error: err.message }); } finally { loading.style.display='none'; }
        }

        function openEditModal(id) { 
            const item = currentRegistrarTlds.find(x=>x.id===id); 
            if (!item) { showAlert('Item not found','danger'); return; } 
            document.getElementById('editId').value=item.id; 
            document.getElementById('editRegistrarId').value=item.registrarId||''; 
            document.getElementById('editRegistrarName').value=item.registrarName||`ID: ${item.registrarId}`; 
            document.getElementById('editTldId').value=item.tldId||''; 
            document.getElementById('editTldExtension').value=item.tldExtension||''; 
            document.getElementById('editRegistrationCost').value=item.registrationCost||0; 
            document.getElementById('editRegistrationPrice').value=item.registrationPrice||0; 
            document.getElementById('editRenewalCost').value=item.renewalCost||0; 
            document.getElementById('editRenewalPrice').value=item.renewalPrice||0; 
            document.getElementById('editTransferCost').value=item.transferCost||0; 
            document.getElementById('editTransferPrice').value=item.transferPrice||0; 
            document.getElementById('editPrivacyCost').value=item.privacyCost||''; 
            document.getElementById('editPrivacyPrice').value=item.privacyPrice||''; 
            document.getElementById('editCurrency').value=item.currency||'USD'; 
            document.getElementById('editIsActive').value = item.isActive? 'true':'false'; 
            document.getElementById('editAutoRenew').value = item.autoRenew? 'true':'false'; 
            document.getElementById('editMinYears').value = item.minRegistrationYears||''; 
            document.getElementById('editMaxYears').value = item.maxRegistrationYears||''; 
            document.getElementById('editNotes').value = item.notes||''; 
            editModal.show(); 
        }

        async function updateRegistrarTld() {
            const id = document.getElementById('editId').value; 
            const data = { 
                registrarId: parseInt(document.getElementById('editRegistrarId').value), 
                tldId: parseInt(document.getElementById('editTldId').value), 
                registrationCost: parseFloat(document.getElementById('editRegistrationCost').value), 
                registrationPrice: parseFloat(document.getElementById('editRegistrationPrice').value), 
                renewalCost: parseFloat(document.getElementById('editRenewalCost').value), 
                renewalPrice: parseFloat(document.getElementById('editRenewalPrice').value), 
                transferCost: parseFloat(document.getElementById('editTransferCost').value), 
                transferPrice: parseFloat(document.getElementById('editTransferPrice').value), 
                privacyCost: document.getElementById('editPrivacyCost').value ? parseFloat(document.getElementById('editPrivacyCost').value) : null, 
                privacyPrice: document.getElementById('editPrivacyPrice').value ? parseFloat(document.getElementById('editPrivacyPrice').value) : null, 
                currency: document.getElementById('editCurrency').value.trim(), 
                isActive: document.getElementById('editIsActive').value === 'true', 
                autoRenew: document.getElementById('editAutoRenew').value === 'true', 
                minRegistrationYears: document.getElementById('editMinYears').value ? parseInt(document.getElementById('editMinYears').value) : null, 
                maxRegistrationYears: document.getElementById('editMaxYears').value ? parseInt(document.getElementById('editMaxYears').value) : null, 
                notes: document.getElementById('editNotes').value.trim() || null 
            };
            try { const res = await fetch(`${API_BASE_URL}/api/v1/RegistrarTlds/${id}`, { method:'PUT', headers: getAuthHeaders(), body: JSON.stringify(data) }); let result; const ct = res.headers.get('content-type'); if (ct && ct.includes('application/json')) result = await res.json(); else { const text = await res.text(); result = { error: text, statusCode: res.status }; } updateResponseBox(result); if (res.ok) { showAlert('Registrar TLD updated','success'); editModal.hide(); getAllRegistrarTlds(); } else showAlert(`Error: ${result.message||result.error||'Failed to update'}`,'danger'); } catch (err) { showAlert(`Error: ${err.message}`,'danger'); updateResponseBox({ error: err.message }); }
        }

        async function deleteRegistrarTld(id, name) { if (!confirm(`Delete TLD "${name}"?`)) return; try { const res = await fetch(`${API_BASE_URL}/api/v1/RegistrarTlds/${id}`, { method:'DELETE', headers: getAuthHeaders() }); if (res.ok) { showAlert('Registrar TLD deleted','success'); getAllRegistrarTlds(); const ct = res.headers.get('content-type'); if (ct && ct.includes('application/json')) updateResponseBox(await res.json()); else updateResponseBox({ message: 'Deleted' }); } else { let result; const ct = res.headers.get('content-type'); if (ct && ct.includes('application/json')) result = await res.json(); else { const text = await res.text(); result = { error: text, statusCode: res.status }; } updateResponseBox(result); showAlert(`Error: ${result.message||result.error||'Failed to delete'}`,'danger'); } } catch (err) { showAlert(`Error: ${err.message}`,'danger'); updateResponseBox({ error: err.message }); } }

        async function bulkUpdateAllStatus() {
            const registrarIdInput = document.getElementById('bulkUpdateAllRegistrarId').value.trim();
            const isActive = document.getElementById('bulkUpdateAllStatus').value === 'true';
            const loading = document.getElementById('loadingBulkUpdateAll');
            const result = document.getElementById('bulkUpdateAllResult');
            loading.style.display = 'block';
            result.innerHTML = '';

            const requestBody = {
                isActive: isActive
            };

            // Add registrarId only if provided
            if (registrarIdInput) {
                requestBody.registrarId = parseInt(registrarIdInput);
            }

            try {
                const res = await fetch(`${API_BASE_URL}/api/v1/RegistrarTlds/bulk-update-status`, {
                    method: 'PUT',
                    headers: getAuthHeaders(),
                    body: JSON.stringify(requestBody)
                });

                let data;
                const ct = res.headers.get('content-type');
                if (ct && ct.includes('application/json')) {
                    data = await res.json();
                } else {
                    const text = await res.text();
                    data = { error: text, statusCode: res.status };
                }

                updateResponseBox(data);

                if (res.ok) {
                    result.innerHTML = `<div class="alert alert-success"><strong>Success!</strong><br/>${data.message}<br/>Records updated: ${data.updatedCount}</div>`;
                    showAlert(data.message, 'success');
                    getAllRegistrarTlds();
                } else {
                    showAlert(`Error: ${data.message || data.error || 'Failed to update'}`, 'danger');
                }
            } catch (err) {
                showAlert(`Error: ${err.message}`, 'danger');
                updateResponseBox({ error: err.message });
            } finally {
                loading.style.display = 'none';
            }
        }

        async function bulkUpdateStatusByTld() {
            const registrarIdInput = document.getElementById('bulkUpdateByTldRegistrarId').value.trim();
            const tldExtensions = document.getElementById('bulkUpdateTldExtensions').value.trim();
            const isActive = document.getElementById('bulkUpdateByTldStatus').value === 'true';
            const loading = document.getElementById('loadingBulkUpdateByTld');
            const result = document.getElementById('bulkUpdateByTldResult');

            if (!tldExtensions) {
                showAlert('Please enter TLD extensions', 'warning');
                return;
            }

            loading.style.display = 'block';
            result.innerHTML = '';

            const requestBody = {
                tldExtensions: tldExtensions,
                isActive: isActive
            };

            // Add registrarId only if provided
            if (registrarIdInput) {
                requestBody.registrarId = parseInt(registrarIdInput);
            }

            try {
                const res = await fetch(`${API_BASE_URL}/api/v1/RegistrarTlds/bulk-update-status-by-tld`, {
                    method: 'PUT',
                    headers: getAuthHeaders(),
                    body: JSON.stringify(requestBody)
                });

                let data;
                const ct = res.headers.get('content-type');
                if (ct && ct.includes('application/json')) {
                    data = await res.json();
                } else {
                    const text = await res.text();
                    data = { error: text, statusCode: res.status };
                }

                updateResponseBox(data);

                if (res.ok) {
                    result.innerHTML = `<div class="alert alert-success"><strong>Success!</strong><br/>${data.message}<br/>Records updated: ${data.updatedCount}</div>`;
                    showAlert(data.message, 'success');
                    getAllRegistrarTlds();
                } else {
                    showAlert(`Error: ${data.message || data.error || 'Failed to update'}`, 'danger');
                }
            } catch (err) {
                showAlert(`Error: ${err.message}`, 'danger');
                updateResponseBox({ error: err.message });
            } finally {
                loading.style.display = 'none';
            }
        }

        // Filter helper functions
        function setFilter(filter) {
            currentFilter = filter;
            
            // Update button states
            document.getElementById('filterAll').classList.remove('active');
            document.getElementById('filterActive').classList.remove('active');
            document.getElementById('filterInactive').classList.remove('active');
            
            if (filter === 'all') {
                document.getElementById('filterAll').classList.add('active');
            } else if (filter === 'active') {
                document.getElementById('filterActive').classList.add('active');
            } else if (filter === 'inactive') {
                document.getElementById('filterInactive').classList.add('active');
            }
            
            // Reset to page 1 when filter changes
            document.getElementById('pageNumber').value = 1;
            
            // Reload data with server-side filter
            getAllRegistrarTlds();
        }

        function setRegistrarFilter(filter) {
            currentRegistrarFilter = filter;
            
            // Update button states
            document.getElementById('registrarFilterAll').classList.remove('active');
            document.getElementById('registrarFilterActive').classList.remove('active');
            document.getElementById('registrarFilterInactive').classList.remove('active');
            
            if (filter === 'all') {
                document.getElementById('registrarFilterAll').classList.add('active');
            } else if (filter === 'active') {
                document.getElementById('registrarFilterActive').classList.add('active');
            } else if (filter === 'inactive') {
                document.getElementById('registrarFilterInactive').classList.add('active');
            }
            
            // Reset to page 1 when filter changes
            document.getElementById('registrarPageNumber').value = 1;
            
            // Reload data with server-side filter
            getTldsForRegistrar();
        }

        // Pagination helper functions
        function renderPagingInfo(pagedResult) {
            const pagingInfo = document.getElementById('pagingInfo');
            const startItem = ((pagedResult.currentPage - 1) * pagedResult.pageSize) + 1;
            const endItem = Math.min(pagedResult.currentPage * pagedResult.pageSize, pagedResult.totalCount);
            
            const filterInfo = currentFilter !== 'all' ? ` (filtered by: ${currentFilter})` : '';
            
            pagingInfo.innerHTML = `
                <div class="alert alert-info mb-0">
                    Showing ${startItem}-${endItem} of ${pagedResult.totalCount} Registrar TLDs${filterInfo}
                    (Page ${pagedResult.currentPage} of ${pagedResult.totalPages})
                </div>
            `;
        }

        function renderPagingControls(pagedResult) {
            const pagingControls = document.getElementById('pagingControls');
            
            let buttonsHtml = '<nav><ul class="pagination justify-content-center">';
            
            // Previous button
            buttonsHtml += `
                <li class="page-item ${!pagedResult.hasPrevious ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="goToPage(${pagedResult.currentPage - 1}); return false;">Previous</a>
                </li>
            `;
            
            // Page numbers
            const maxPagesToShow = 5;
            let startPage = Math.max(1, pagedResult.currentPage - Math.floor(maxPagesToShow / 2));
            let endPage = Math.min(pagedResult.totalPages, startPage + maxPagesToShow - 1);
            
            if (endPage - startPage < maxPagesToShow - 1) {
                startPage = Math.max(1, endPage - maxPagesToShow + 1);
            }
            
            if (startPage > 1) {
                buttonsHtml += `<li class="page-item"><a class="page-link" href="#" onclick="goToPage(1); return false;">1</a></li>`;
                if (startPage > 2) {
                    buttonsHtml += `<li class="page-item disabled"><span class="page-link">...</span></li>`;
                }
            }
            
            for (let i = startPage; i <= endPage; i++) {
                buttonsHtml += `
                    <li class="page-item ${i === pagedResult.currentPage ? 'active' : ''}">
                        <a class="page-link" href="#" onclick="goToPage(${i}); return false;">${i}</a>
                    </li>
                `;
            }
            
            if (endPage < pagedResult.totalPages) {
                if (endPage < pagedResult.totalPages - 1) {
                    buttonsHtml += `<li class="page-item disabled"><span class="page-link">...</span></li>`;
                }
                buttonsHtml += `<li class="page-item"><a class="page-link" href="#" onclick="goToPage(${pagedResult.totalPages}); return false;">${pagedResult.totalPages}</a></li>`;
            }
            
            // Next button
            buttonsHtml += `
                <li class="page-item ${!pagedResult.hasNext ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="goToPage(${pagedResult.currentPage + 1}); return false;">Next</a>
                </li>
            `;
            
            buttonsHtml += '</ul></nav>';
            pagingControls.innerHTML = buttonsHtml;
        }

        function goToPage(page) {
            document.getElementById('pageNumber').value = page;
            getAllRegistrarTlds();
        }

        function renderRegistrarPagingInfo(pagedResult) {
            const pagingInfo = document.getElementById('registrarPagingInfo');
            const startItem = ((pagedResult.currentPage - 1) * pagedResult.pageSize) + 1;
            const endItem = Math.min(pagedResult.currentPage * pagedResult.pageSize, pagedResult.totalCount);
            
            const filterInfo = currentRegistrarFilter !== 'all' ? ` (filtered by: ${currentRegistrarFilter})` : '';
            
            pagingInfo.innerHTML = `
                <div class="alert alert-info mb-0">
                    Showing ${startItem}-${endItem} of ${pagedResult.totalCount} TLDs${filterInfo}
                    (Page ${pagedResult.currentPage} of ${pagedResult.totalPages})
                </div>
            `;
        }

        function renderRegistrarPagingControls(pagedResult) {
            const pagingControls = document.getElementById('registrarPagingControls');
            
            let buttonsHtml = '<nav><ul class="pagination justify-content-center">';
            
            // Previous button
            buttonsHtml += `
                <li class="page-item ${!pagedResult.hasPrevious ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="goToRegistrarPage(${pagedResult.currentPage - 1}); return false;">Previous</a>
                </li>
            `;
            
            // Page numbers
            const maxPagesToShow = 5;
            let startPage = Math.max(1, pagedResult.currentPage - Math.floor(maxPagesToShow / 2));
            let endPage = Math.min(pagedResult.totalPages, startPage + maxPagesToShow - 1);
            
            if (endPage - startPage < maxPagesToShow - 1) {
                startPage = Math.max(1, endPage - maxPagesToShow + 1);
            }
            
            if (startPage > 1) {
                buttonsHtml += `<li class="page-item"><a class="page-link" href="#" onclick="goToRegistrarPage(1); return false;">1</a></li>`;
                if (startPage > 2) {
                    buttonsHtml += `<li class="page-item disabled"><span class="page-link">...</span></li>`;
                }
            }
            
            for (let i = startPage; i <= endPage; i++) {
                buttonsHtml += `
                    <li class="page-item ${i === pagedResult.currentPage ? 'active' : ''}">
                        <a class="page-link" href="#" onclick="goToRegistrarPage(${i}); return false;">${i}</a>
                    </li>
                `;
            }
            
            if (endPage < pagedResult.totalPages) {
                if (endPage < pagedResult.totalPages - 1) {
                    buttonsHtml += `<li class="page-item disabled"><span class="page-link">...</span></li>`;
                }
                buttonsHtml += `<li class="page-item"><a class="page-link" href="#" onclick="goToRegistrarPage(${pagedResult.totalPages}); return false;">${pagedResult.totalPages}</a></li>`;
            }
            
            // Next button
            buttonsHtml += `
                <li class="page-item ${!pagedResult.hasNext ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="goToRegistrarPage(${pagedResult.currentPage + 1}); return false;">Next</a>
                </li>
            `;
            
            buttonsHtml += '</ul></nav>';
            pagingControls.innerHTML = buttonsHtml;
        }

        function goToRegistrarPage(page) {
            document.getElementById('registrarPageNumber').value = page;
            getTldsForRegistrar();
        }
    </script>
</body>
</html>

